{% extends 'base.html' %}

{% block title %}Modifier mon profil - TalentZik{% endblock %}

{% block extra_css %}
<style>
    .search-input {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23374151'%3e%3cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'%3e%3c/path%3e%3c/svg%3e");
        background-position: 16px center;
        background-repeat: no-repeat;
        background-size: 18px 18px;
        background-color: white;
        padding-right: 16px;
    }
    
    .category-card {
        transition: all 0.3s ease;
    }
    
    .category-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .traditional-badge {
        background: linear-gradient(135deg, #065f46, #059669);
    }
    
    .modern-badge {
        background: linear-gradient(135deg, #1e40af, #3b82f6);
    }
    
    .tooltip {
        position: relative;
    }
    
    .tooltip:hover .tooltip-text {
        visibility: visible;
        opacity: 1;
        transform: translateY(-10px);
    }
    
    .tooltip-text {
        visibility: hidden;
        opacity: 0;
        width: 320px;
        background-color: #374151;
        color: white;
        text-align: left;
        border-radius: 8px;
        padding: 12px;
        position: absolute;
        z-index: 1000;
        bottom: 125%;
        left: 50%;
        margin-left: -160px;
        transition: all 0.3s ease;
        font-size: 14px;
        line-height: 1.4;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .tooltip-text::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #374151 transparent transparent transparent;
    }
    
    .tab-active {
        background: #3c1361;
        color: white;
        box-shadow: 0 4px 12px rgba(60, 19, 97, 0.3);
    }
    
    .tab-inactive {
        background: white;
        color: #6b7280;
        border: 1px solid #e5e7eb;
    }
</style>
{% endblock %}

{% block content %}
<div class="bg-white min-h-screen py-8">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- En-tÃªte patriotique -->
        <div class="bg-white rounded-xl shadow-lg border border-gray-200 mb-8 overflow-hidden">
            <div class="px-6 py-4" style="background-color: #3c1361;">
                <div class="flex items-center text-white">
                    <div>
                        <h1 class="text-3xl font-bold">Valorisez votre talent</h1>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 bg-white">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fas fa-user-edit text-orange-600 text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold text-gray-900">Modification du profil</h2>
                        <p class="text-gray-600">Mettez vous en avant</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Messages -->
        {% if messages %}
            {% for message in messages %}
                <div class="mb-6 p-4 rounded-xl {% if message.tags == 'success' %}bg-green-50 border border-green-200 text-green-800{% elif message.tags == 'error' %}bg-red-50 border border-red-200 text-red-800{% else %}bg-blue-50 border border-blue-200 text-blue-800{% endif %}">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            {% if message.tags == 'success' %}
                                <i class="fas fa-check-circle"></i>
                            {% elif message.tags == 'error' %}
                                <i class="fas fa-exclamation-circle"></i>
                            {% else %}
                                <i class="fas fa-info-circle"></i>
                            {% endif %}
                        </div>
                        <div class="ml-3">
                            {{ message }}
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% endif %}

        <!-- Navigation par onglets -->
        <div class="mb-8">
            <div class="flex flex-wrap gap-2" role="tablist">
                <button class="tab-button px-8 py-4 rounded-lg font-medium transition-all duration-200 tab-active" data-tab="general">
                    ðŸ“‹ Informations GÃ©nÃ©rales
                </button>
                {% if user.user_type == 'artist' %}
                <button class="tab-button px-8 py-4 rounded-lg font-medium transition-all duration-200 tab-inactive" data-tab="skills">
                    ðŸŽ­ CompÃ©tences
                </button>
                {% endif %}
            </div>
        </div>

        <!-- Formulaire -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <form method="post" enctype="multipart/form-data" id="profile-form">
                {% csrf_token %}
                
                <!-- Onglet Informations GÃ©nÃ©rales -->
                <div class="tab-content" id="general-tab">
                    <div class="px-8 py-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-8 flex items-center">
                            <i class="fas fa-id-card mr-3 text-orange-600"></i>
                            Informations GÃ©nÃ©rales
                        </h3>
                        
                        <!-- Section Informations personnelles -->
                        <div class="mb-12">
                            <h4 class="text-lg font-semibold text-gray-800 mb-6 flex items-center border-b border-gray-200 pb-2">
                                <i class="fas fa-user mr-2 text-orange-500"></i>
                                Informations personnelles
                            </h4>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Photo de profil -->
                            {% if user.user_type == 'artist' %}
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-3">
                                    Photo de profil
                                </label>
                                <div class="flex items-center space-x-6">
                                    {% if user.artist_profile.profile_picture %}
                                        <img src="{{ user.artist_profile.profile_picture.url }}" alt="Photo de profil" class="w-24 h-24 rounded-full object-cover border-4 border-orange-200">
                                    {% else %}
                                        <div class="w-24 h-24 rounded-full flex items-center justify-center" style="background-color: #3c1361;">
                                            <i class="fas fa-user text-white text-3xl"></i>
                                        </div>
                                    {% endif %}
                                    <div>
                                        {{ form.profile_picture }}
                                        <p class="text-sm text-gray-500 mt-2">JPG, PNG ou GIF. Taille max : 5MB</p>
                                    </div>
                                </div>
                                {% if form.profile_picture.errors %}
                                    <div class="mt-2 text-sm text-red-600">
                                        {% for error in form.profile_picture.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            {% endif %}
                            
                            <!-- PrÃ©nom -->
                            <div>
                                <label for="{{ form.first_name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.first_name.label }}
                                    <span class="text-red-500">*</span>
                                </label>
                                {{ form.first_name }}
                                {% if form.first_name.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.first_name.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <!-- Nom -->
                            <div>
                                <label for="{{ form.last_name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.last_name.label }}
                                    <span class="text-red-500">*</span>
                                </label>
                                {{ form.last_name }}
                                {% if form.last_name.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.last_name.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <!-- Email -->
                            <div>
                                <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.email.label }}
                                    <span class="text-red-500">*</span>
                                </label>
                                {{ form.email }}
                                {% if form.email.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.email.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <!-- TÃ©lÃ©phone -->
                            <div>
                                <label for="{{ form.phone_number.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.phone_number.label }}
                                    <span class="text-red-500">*</span>
                                </label>
                                {{ form.phone_number }}
                                {% if form.phone_number.help_text %}
                                    <p class="mt-1 text-sm text-gray-500">{{ form.phone_number.help_text }}</p>
                                {% endif %}
                                {% if form.phone_number.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.phone_number.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <!-- Ville -->
                            <div>
                                <label for="{{ form.city.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.city.label }}
                                    <span class="text-red-500">*</span>
                                </label>
                                {{ form.city }}
                                {% if form.city.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.city.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                        </div>
                    </div>
                </div>

                {% if user.user_type == 'artist' %}
                        <!-- Section IdentitÃ© artistique -->
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-6 flex items-center border-b border-gray-200 pb-2">
                                <i class="fas fa-music mr-2 text-orange-500"></i>
                            IdentitÃ© artistique
                            </h4>
                        
                        <div class="space-y-6">
                            <!-- Nom d'artiste -->
                            <div>
                                <label for="{{ form.stage_name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.stage_name.label }}
                                </label>
                                {{ form.stage_name }}
                                {% if form.stage_name.help_text %}
                                    <p class="mt-1 text-sm text-gray-500">{{ form.stage_name.help_text }}</p>
                                {% endif %}
                                {% if form.stage_name.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.stage_name.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <!-- Bio -->
                            <div>
                                <label for="{{ form.bio.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    <i class="fas fa-user-circle mr-1 text-orange-500"></i>
                                    {{ form.bio.label }}
                                </label>
                                {{ form.bio }}
                                {% if form.bio.help_text %}
                                    <p class="mt-1 text-sm text-gray-500">{{ form.bio.help_text }}</p>
                                {% endif %}
                                {% if form.bio.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {% for error in form.bio.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                {% if user.user_type == 'artist' %}
                <!-- Onglet CompÃ©tences -->
                <div class="tab-content hidden" id="skills-tab">
                    <div class="px-8 py-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-8 flex items-center">
                            <i class="fas fa-star mr-3 text-orange-600"></i>
                            Vos CompÃ©tences Musicales
                        </h3>
                        
                        <!-- RÃ´les et spÃ©cialitÃ©s -->
                        <div class="mb-12">
                            <div class="flex items-center justify-between mb-6">
                                <h4 class="text-lg font-semibold text-gray-800 flex items-center border-b border-gray-200 pb-2">
                                    <i class="fas fa-users mr-2 text-orange-500"></i>
                                    RÃ´les et spÃ©cialitÃ©s
                                </h4>
                                <input type="text" id="roles-search" placeholder="Rechercher un rÃ´le..." 
                                       class="search-input px-10 py-2 border border-gray-300 rounded-lg text-sm w-64">
                            </div>
                            
                            <div class="category-card bg-gradient-to-br from-yellow-50 to-amber-100 rounded-xl p-6 border border-yellow-200">
                                <div id="roles-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                    {% for role in form.roles.field.queryset %}
                                        <div class="role-item tooltip">
                                            <label class="flex items-center p-3 rounded-lg hover:bg-white transition-colors duration-200 cursor-pointer">
                                                <input type="checkbox" name="{{ form.roles.name }}" value="{{ role.id }}" 
                                                       {% if role.id in selected_roles %}checked{% endif %}
                                                       class="rounded border-gray-300 text-orange-600 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50 mr-3">
                                                <span class="text-sm font-medium text-gray-700 role-name">{{ role.name }}</span>
                                            </label>
                                            <div class="tooltip-text">
                                                <strong>{{ role.name }}</strong><br>
                                                <em>SpÃ©cialitÃ© musicale</em><br>
                                                {{ role.description|default:"RÃ´le dans l'univers musical." }}
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                                
                                {% if form.roles.help_text %}
                                    <p class="mt-4 text-sm text-orange-700 flex items-center">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        {{ form.roles.help_text }}
                                    </p>
                                {% endif %}
                                {% if form.roles.errors %}
                                    <div class="mt-2 text-sm text-red-600">
                                        {% for error in form.roles.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Genres musicaux -->
                        <div class="mb-12">
                            <div class="flex items-center justify-between mb-6">
                                <h4 class="text-lg font-semibold text-gray-800 flex items-center border-b border-gray-200 pb-2">
                                    <i class="fas fa-music mr-2 text-orange-500"></i>
                                    Genres musicaux
                                </h4>
                                <input type="text" id="genres-search" placeholder="Rechercher un genre..." 
                                       class="search-input px-10 py-2 border border-gray-300 rounded-lg text-sm w-64">
                            </div>
                            
                            <div class="category-card bg-gradient-to-br from-purple-50 to-indigo-100 rounded-xl p-6 border border-purple-200">
                                <!-- Genres traditionnels -->
                                <div class="mb-8">
                                    <h5 class="text-md font-semibold text-purple-800 mb-4 flex items-center">
                                        <i class="fas fa-drum mr-2"></i>
                                        Genres traditionnels camerounais
                                    </h5>
                                    <div id="traditional-genres-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 pl-4">
                                        {% for genre in form.genres_traditional.field.queryset %}
                                            <div class="genre-item tooltip">
                                                <label class="flex items-center p-3 rounded-lg hover:bg-white transition-colors duration-200 cursor-pointer">
                                                    <input type="checkbox" name="{{ form.genres_traditional.name }}" value="{{ genre.id }}" 
                                                           {% if genre.id in selected_genres_traditional %}checked{% endif %}
                                                           class="rounded border-gray-300 text-green-600 shadow-sm focus:border-green-300 focus:ring focus:ring-green-200 focus:ring-opacity-50 mr-3">
                                                    <span class="ml-3 text-sm font-medium text-gray-700 genre-name">{{ genre.name }}</span>
                                                </label>
                                                <div class="tooltip-text">
                                                    <strong>{{ genre.name }}</strong><br>
                                                    <em>Genre traditionnel camerounais</em><br>
                                                    {{ genre.description|default:"Style musical traditionnel du patrimoine camerounais." }}
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>

                                <!-- Genres modernes -->
                                <div>
                                    <h5 class="text-md font-semibold text-purple-800 mb-4 flex items-center">
                                        <i class="fas fa-globe-americas mr-2"></i>
                                        Genres modernes et internationaux
                                    </h5>
                                    <div id="modern-genres-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 pl-4">
                                        {% for genre in form.genres_modern.field.queryset %}
                                            <div class="genre-item tooltip">
                                                <label class="flex items-center p-3 rounded-lg hover:bg-white transition-colors duration-200 cursor-pointer">
                                                    <input type="checkbox" name="{{ form.genres_modern.name }}" value="{{ genre.id }}" 
                                                           {% if genre.id in selected_genres_modern %}checked{% endif %}
                                                           class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 mr-3">
                                                    <span class="ml-3 text-sm font-medium text-gray-700 genre-name">{{ genre.name }}</span>
                                                </label>
                                                <div class="tooltip-text">
                                                    <strong>{{ genre.name }}</strong><br>
                                                    <em>Genre moderne/international</em><br>
                                                    {{ genre.description|default:"Style musical contemporain et international." }}
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                                
                                {% if form.genres_traditional.help_text or form.genres_modern.help_text %}
                                    <p class="mt-4 text-sm text-purple-700 flex items-center">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        SÃ©lectionnez les genres qui correspondent Ã  votre style musical
                                    </p>
                                {% endif %}
                                {% if form.genres_traditional.errors or form.genres_modern.errors %}
                                    <div class="mt-2 text-sm text-red-600">
                                        {% for error in form.genres_traditional.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                        {% for error in form.genres_modern.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Instruments traditionnels -->
                        <div class="mb-12">
                            <div class="flex items-center justify-between mb-6">
                                <h4 class="text-lg font-semibold text-gray-800 flex items-center border-b border-gray-200 pb-2">
                                    <i class="fas fa-drum mr-2 text-orange-500"></i>
                                    Instruments traditionnels
                                </h4>
                                <input type="text" id="traditional-instruments-search" placeholder="Rechercher un instrument..." 
                                       class="search-input px-10 py-2 border border-gray-300 rounded-lg text-sm w-64">
                            </div>
                            
                            <div class="category-card bg-gradient-to-br from-amber-50 to-orange-100 rounded-xl p-6 border border-amber-200">
                                <!-- Organisation manuelle par catÃ©gories pour les instruments traditionnels -->
                                <div id="traditional-instruments-container">
                                    {% for instrument in form.instruments_traditional.field.queryset %}
                                        <div class="instrument-item tooltip" data-category="{{ instrument.get_instrument_category }}" style="display: none;">
                                            <label class="flex items-center p-3 rounded-lg hover:bg-white transition-colors duration-200 cursor-pointer">
                                                <input type="checkbox" name="{{ form.instruments_traditional.name }}" value="{{ instrument.id }}" 
                                                       {% if instrument.id in selected_instruments_traditional %}checked{% endif %}
                                                       class="rounded border-gray-300 text-amber-600 shadow-sm focus:border-amber-300 focus:ring focus:ring-amber-200 focus:ring-opacity-50 mr-3">
                                                <span class="text-sm font-medium text-gray-700 instrument-name">{{ instrument.name }}</span>
                                            </label>
                                            <div class="tooltip-text">
                                                <strong>{{ instrument.name }}</strong><br>
                                                <em>{{ instrument.get_instrument_category }}</em><br>
                                                {{ instrument.description|default:"Instrument du patrimoine musical africain." }}
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                                
                                {% if form.instruments_traditional.help_text %}
                                    <p class="mt-4 text-sm text-amber-700 flex items-center">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        {{ form.instruments_traditional.help_text }}
                                    </p>
                                {% endif %}
                                {% if form.instruments_traditional.errors %}
                                    <div class="mt-2 text-sm text-red-600">
                                        {% for error in form.instruments_traditional.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Instruments modernes -->
                        <div>
                            <div class="flex items-center justify-between mb-6">
                                <h4 class="text-lg font-semibold text-gray-800 flex items-center border-b border-gray-200 pb-2">
                                    <i class="fas fa-guitar mr-2 text-orange-500"></i>
                                    Instruments modernes
                                </h4>
                                <input type="text" id="modern-instruments-search" placeholder="Rechercher un instrument..." 
                                       class="search-input px-10 py-2 border border-gray-300 rounded-lg text-sm w-64">
                            </div>
                            
                            <div class="category-card bg-gradient-to-br from-blue-50 to-cyan-100 rounded-xl p-6 border border-blue-200">
                                <!-- Organisation manuelle par catÃ©gories pour les instruments modernes -->
                                <div id="modern-instruments-container">
                                    {% for instrument in form.instruments_modern.field.queryset %}
                                        <div class="instrument-item tooltip" data-category="{{ instrument.get_instrument_category }}" style="display: none;">
                                            <label class="flex items-center p-3 rounded-lg hover:bg-white transition-colors duration-200 cursor-pointer">
                                                <input type="checkbox" name="{{ form.instruments_modern.name }}" value="{{ instrument.id }}" 
                                                       {% if instrument.id in selected_instruments_modern %}checked{% endif %}
                                                       class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 mr-3">
                                                <span class="text-sm font-medium text-gray-700 instrument-name">{{ instrument.name }}</span>
                                            </label>
                                            <div class="tooltip-text">
                                                <strong>{{ instrument.name }}</strong><br>
                                                <em>{{ instrument.get_instrument_category }}</em><br>
                                                {{ instrument.description|default:"Instrument de musique moderne." }}
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                                
                                {% if form.instruments_modern.help_text %}
                                    <p class="mt-4 text-sm text-blue-700 flex items-center">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        {{ form.instruments_modern.help_text }}
                                    </p>
                                {% endif %}
                                {% if form.instruments_modern.errors %}
                                    <div class="mt-2 text-sm text-red-600">
                                        {% for error in form.instruments_modern.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Erreurs gÃ©nÃ©rales -->
                {% if form.non_field_errors %}
                    <div class="px-8 py-6">
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-circle text-red-400"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-red-800">Erreurs de validation</h3>
                                    <div class="mt-2 text-sm text-red-700">
                                        {% for error in form.non_field_errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}

                <!-- Actions -->
                <div class="px-8 py-6 bg-gray-50 flex items-center justify-between">
                    <a href="{% url 'accounts:profile' %}" class="inline-flex items-center px-6 py-3 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors duration-200">
                        <i class="fas fa-arrow-left mr-2"></i>
                        Retour au profil
                    </a>
                    
                    <button type="submit" class="inline-flex items-center px-8 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-all duration-200 shadow-lg">
                        <i class="fas fa-save mr-2"></i>
                        Enregistrer les modifications
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Section supplÃ©mentaire -->
        <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4 flex items-center">
                <i class="fas fa-cog mr-2 text-gray-600"></i>
                Actions du compte
            </h3>
            <div class="flex flex-wrap gap-4">
                <a href="{% url 'accounts:change_password' %}" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200">
                    <i class="fas fa-key mr-2"></i>
                    Changer le mot de passe
                </a>
                {% if user.user_type == 'artist' %}
                <a href="{% url 'media_files:portfolio' %}" class="inline-flex items-center px-4 py-2 border border-orange-300 rounded-lg text-sm font-medium text-orange-700 bg-orange-50 hover:bg-orange-100 transition-colors duration-200">
                    <i class="fas fa-folder-open mr-2"></i>
                    GÃ©rer mon portfolio
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<script>
// JavaScript pour la navigation par onglets et la recherche
document.addEventListener('DOMContentLoaded', function() {
    // Navigation par onglets
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetTab = this.getAttribute('data-tab');
            
            // DÃ©sactiver tous les onglets
            tabButtons.forEach(btn => {
                btn.classList.remove('tab-active');
                btn.classList.add('tab-inactive');
            });
            
            // Activer l'onglet cliquÃ©
            this.classList.remove('tab-inactive');
            this.classList.add('tab-active');
            
            // Masquer tous les contenus
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            // Afficher le contenu correspondant
            const targetContent = document.getElementById(targetTab + '-tab');
            if (targetContent) {
                targetContent.classList.remove('hidden');
            }
        });
    });
    
    // Fonction de recherche gÃ©nÃ©rique
    function setupSearch(inputId, containerId, itemClass, nameClass) {
        const searchInput = document.getElementById(inputId);
        
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const containers = document.querySelectorAll('[id*="' + containerId.replace('-container', '') + '"]');
                
                containers.forEach(container => {
                    const items = container.querySelectorAll('.' + itemClass);
                items.forEach(item => {
                    const name = item.querySelector('.' + nameClass);
                    if (name) {
                        const text = name.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            item.style.display = 'block';
                        } else {
                            item.style.display = 'none';
                        }
                    }
                    });
                });
            });
        }
    }
    
    // Configuration des recherches pour chaque section
    setupSearch('roles-search', 'roles-container', 'role-item', 'role-name');
    setupSearch('genres-search', 'genres-container', 'genre-item', 'genre-name');
    setupSearch('traditional-instruments-search', 'traditional-instruments-container', 'instrument-item', 'instrument-name');
    setupSearch('modern-instruments-search', 'modern-instruments-container', 'instrument-item', 'instrument-name');
    
    // Organisation des instruments par catÃ©gorie
    function organizeInstrumentsByCategory(containerId, colorClass) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        const instruments = container.querySelectorAll('.instrument-item');
        const categories = {};
        
        // Regrouper les instruments par catÃ©gorie
        instruments.forEach(instrument => {
            const category = instrument.getAttribute('data-category');
            if (!categories[category]) {
                categories[category] = [];
            }
            categories[category].push(instrument);
        });
        
        // Effacer le conteneur
        container.innerHTML = '';
        
        // Trier les catÃ©gories alphabÃ©tiquement
        const sortedCategories = Object.keys(categories).sort();
        
        // CrÃ©er les sections pour chaque catÃ©gorie
        sortedCategories.forEach(categoryName => {
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'mb-6';
            
            const categoryHeader = document.createElement('h5');
            categoryHeader.className = `text-md font-semibold ${colorClass} mb-3 flex items-center`;
            categoryHeader.innerHTML = `
                <i class="fas fa-folder-open mr-2"></i>
                ${categoryName}
            `;
            
            const categoryGrid = document.createElement('div');
            categoryGrid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 pl-4';
            
            // Trier les instruments alphabÃ©tiquement dans chaque catÃ©gorie
            categories[categoryName].sort((a, b) => {
                const nameA = a.querySelector('.instrument-name').textContent;
                const nameB = b.querySelector('.instrument-name').textContent;
                return nameA.localeCompare(nameB);
            });
            
            // Ajouter les instruments Ã  la grille
            categories[categoryName].forEach(instrument => {
                instrument.style.display = 'block';
                categoryGrid.appendChild(instrument);
            });
            
            categoryDiv.appendChild(categoryHeader);
            categoryDiv.appendChild(categoryGrid);
            container.appendChild(categoryDiv);
        });
    }
    
    // Organiser les instruments traditionnels et modernes
    organizeInstrumentsByCategory('traditional-instruments-container', 'text-amber-800');
    organizeInstrumentsByCategory('modern-instruments-container', 'text-blue-800');
});
</script>
{% endblock %} 